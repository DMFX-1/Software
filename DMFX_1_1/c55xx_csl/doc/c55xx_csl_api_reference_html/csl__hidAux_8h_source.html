<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>C55XX CSL LP: csl_hidAux.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">C55XX CSL LP</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">csl_hidAux.h</div>  </div>
</div>
<div class="contents">
<a href="csl__hidAux_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* ============================================================================</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 2008-2012 Texas Instruments Incorporated.</span>
<a name="l00003"></a>00003 <span class="comment"> * Except for those rights granted to you in your license from TI, all rights</span>
<a name="l00004"></a>00004 <span class="comment"> * reserved.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Software License Agreement</span>
<a name="l00007"></a>00007 <span class="comment"> * Texas Instruments (TI) is supplying this software for use solely and</span>
<a name="l00008"></a>00008 <span class="comment"> * exclusively on TI devices. The software is owned by TI and/or its suppliers,</span>
<a name="l00009"></a>00009 <span class="comment"> * and is protected under applicable patent and copyright laws.  You may not</span>
<a name="l00010"></a>00010 <span class="comment"> * combine this software with any open-source software if such combination would</span>
<a name="l00011"></a>00011 <span class="comment"> * cause this software to become subject to any of the license terms applicable</span>
<a name="l00012"></a>00012 <span class="comment"> * to such open source software.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND WITH ALL FAULTS.</span>
<a name="l00015"></a>00015 <span class="comment"> * NO WARRANTIES APPLY TO THIS SOFTWARE, WHETHER EXPRESS, IMPLIED OR STATUTORY.</span>
<a name="l00016"></a>00016 <span class="comment"> * EXAMPLES OF EXCLUDED WARRANTIES ARE IMPLIED WARRANTIES OF MERCHANTABILITY</span>
<a name="l00017"></a>00017 <span class="comment"> * AND FITNESS FOR A PARTICULAR PURPOSE AND WARRANTIES OF NON-INFRINGEMENT,</span>
<a name="l00018"></a>00018 <span class="comment"> * BUT ALL OTHER WARRANTY EXCLUSIONS ALSO APPLY. FURTHERMORE, TI SHALL NOT,</span>
<a name="l00019"></a>00019 <span class="comment"> * UNDER ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL, CONSEQUENTIAL</span>
<a name="l00020"></a>00020 <span class="comment"> * OR PUNITIVE DAMAGES, FOR ANY REASON WHATSOEVER.</span>
<a name="l00021"></a>00021 <span class="comment"> * ============================================================================</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00031"></a>00031 <span class="comment">/* ============================================================================</span>
<a name="l00032"></a>00032 <span class="comment"> * Revision History</span>
<a name="l00033"></a>00033 <span class="comment"> * ================</span>
<a name="l00034"></a>00034 <span class="comment"> * 13-Dec-2012 Created</span>
<a name="l00035"></a>00035 <span class="comment"> * ============================================================================</span>
<a name="l00036"></a>00036 <span class="comment"> */</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="preprocessor">#ifndef _CSL_HIDCLASSAUX_H_</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#define _CSL_HIDCLASSAUX_H_</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a>00041 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00043"></a>00043 <span class="preprocessor">#endif</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="csl__hid_8h.html" title="USB HID Class functional layer API header file.">csl_hid.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="csl__usbAux_8h.html" title="USB MUSB functional layer Auxiliary header file.">csl_usbAux.h</a>&quot;</span>
<a name="l00048"></a>00048 
<a name="l00106"></a>00106 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00107"></a><a class="code" href="group__CSL__HID__FUNCTION.html#gaca74b5dfb0e97d50c1c9019c8bc04745">00107</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#gaca74b5dfb0e97d50c1c9019c8bc04745">HID_reqUnknown</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00108"></a>00108                                  <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00109"></a>00109                                  <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00110"></a>00110                                  <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00111"></a>00111                                  <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00112"></a>00112 {
<a name="l00113"></a>00113     <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a>    retStat;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <span class="comment">/* STALL the endpoint - the request is either not known or not supported */</span>
<a name="l00116"></a>00116     retStat = CSL_HID_REQUEST_STALL;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118     <span class="keywordflow">return</span>(retStat);
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00171"></a>00171 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00172"></a><a class="code" href="group__CSL__HID__FUNCTION.html#ga354e3a4d776b639ff9279f77da2b8765">00172</a> <a class="code" href="group__CSL__HID__DATASTRUCT.html#ga904e8be162b488fb879fa91a6dcef28c" title="Hid Class request handler function pointer.">fpHID_REQ_HANDLER</a> <a class="code" href="group__CSL__HID__FUNCTION.html#ga354e3a4d776b639ff9279f77da2b8765">HID_lookupReqHandler</a>(Uint16                 request,
<a name="l00173"></a>00173                                      <a class="code" href="structCSL__HidRequestStruct.html" title="Hid Class control request structure.">CSL_HidRequestStruct</a>    *pUSB_ReqTable)
<a name="l00174"></a>00174 {
<a name="l00175"></a>00175     Uint16    index;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="comment">/* parse thru the end of request handler table */</span>
<a name="l00178"></a>00178     <span class="keywordflow">for</span>(index = 0; pUSB_ReqTable[index].<a class="code" href="structCSL__HidRequestStruct.html#a093854d1be8f41f1b02d3044b0965e54" title="HID control request handler pointer.">fpRequestHandler</a> != NULL; index++)
<a name="l00179"></a>00179     {
<a name="l00180"></a>00180         <span class="comment">/* if request handler exists return a pointer to the request handler routine */</span>
<a name="l00181"></a>00181         <span class="keywordflow">if</span>(pUSB_ReqTable[index].request == request)
<a name="l00182"></a>00182         {
<a name="l00183"></a>00183             <span class="keywordflow">return</span>(pUSB_ReqTable[index].fpRequestHandler);
<a name="l00184"></a>00184         }
<a name="l00185"></a>00185     }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187     <span class="comment">/* if request handler does not exist return a pointer to the USB_reqUnknown</span>
<a name="l00188"></a>00188 <span class="comment">    routine */</span>
<a name="l00189"></a>00189     <span class="comment">//printf(&quot;unknown\n&quot;);</span>
<a name="l00190"></a>00190     <span class="keywordflow">return</span>(<a class="code" href="group__CSL__HID__FUNCTION.html#gaca74b5dfb0e97d50c1c9019c8bc04745">HID_reqUnknown</a>);
<a name="l00191"></a>00191 }
<a name="l00192"></a>00192 
<a name="l00246"></a>00246 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00247"></a><a class="code" href="group__CSL__HID__FUNCTION.html#gabae401b8e6af0ebea83448537fc008e7">00247</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#gabae401b8e6af0ebea83448537fc008e7">HID_reqSetAddress</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00248"></a>00248                                     <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00249"></a>00249                                     <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00250"></a>00250                                     <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00251"></a>00251                                     <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253     CSL_FINS(<a class="code" href="group__CSL__CDC__DATASTRUCT.html#ga3a779f02649275a99b98db0eec619e5f">usbRegisters</a>-&gt;PERI_CSR0_INDX,
<a name="l00254"></a>00254          USB_PERI_CSR0_INDX_SERV_SETUPEND, TRUE);
<a name="l00255"></a>00255     CSL_FINS(<a class="code" href="group__CSL__CDC__DATASTRUCT.html#ga3a779f02649275a99b98db0eec619e5f">usbRegisters</a>-&gt;PERI_CSR0_INDX,
<a name="l00256"></a>00256          USB_PERI_CSR0_INDX_DATAEND, TRUE);
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     <a class="code" href="group__CSL__USB__FUNCTION.html#ga25cb72d6bce692e49d554479df7c9173">USB_setDevAddr</a>(devHandle, (Uint16)(usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a>));
<a name="l00259"></a>00259 
<a name="l00260"></a>00260     <span class="keywordflow">return</span>(CSL_HID_REQUEST_DONE);
<a name="l00261"></a>00261 }
<a name="l00262"></a>00262 
<a name="l00313"></a>00313 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00314"></a><a class="code" href="group__CSL__HID__FUNCTION.html#ga1183876eee179bef501be7c72e75047c">00314</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#ga1183876eee179bef501be7c72e75047c">HID_reqGetDescriptor</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00315"></a>00315                                        <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00316"></a>00316                                        <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00317"></a>00317                                        <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00318"></a>00318                                        <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00319"></a>00319 {
<a name="l00320"></a>00320     Uint16    Desc_length;
<a name="l00321"></a>00321     Uint16    incrPtr;
<a name="l00322"></a>00322     Uint16    inOutFlag;
<a name="l00323"></a>00323     <span class="keywordtype">char</span>      *destPtr;
<a name="l00324"></a>00324     <a class="code" href="structCSL__HidClassStruct.html" title="HID Control Object structure.">pHidClassHandle</a>       pHIDClassHdl;
<a name="l00325"></a>00325     <a class="code" href="structCSL__HidCtrlObject.html" title="USB HID Control Object structure.">CSL_HidCtrlObject</a>*    pCtrlHandle;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327     pHIDClassHdl = (<a class="code" href="group__CSL__HID__DATASTRUCT.html#ga9ecd1a15a6500054d7691fb78b9feb5c" title="Hid Class class handle.">pHidClassHandle</a>)(pHidObj);
<a name="l00328"></a>00328     pCtrlHandle  = &amp;pHIDClassHdl-&gt;<a class="code" href="structCSL__HidClassStruct.html#a159f6e7bfae4815bb6e6e83583b8678d" title="Handle to Control Object.">ctrlHandle</a>;
<a name="l00329"></a>00329     destPtr      = NULL;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     <span class="keywordflow">switch</span>(usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a> &gt;&gt; <a class="code" href="group__CSL__HID__SYMBOL.html#gab3bc25e83b45a2d5c88995b4880e2371">CSL_HID_8BIT_SHIFT</a>)
<a name="l00332"></a>00332     {
<a name="l00333"></a>00333         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga562ecd768fe0a8835ca02e4900c55ce8" title="USB Descriptor Type Values.">CSL_USB_DEVICE_DESCRIPTOR_TYPE</a>:
<a name="l00334"></a>00334              Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#adeb60802490746e21cfbed00687741c1" title="Device descriptor.">deviceDescr</a>[1]&amp;0xFF;
<a name="l00335"></a>00335              destPtr     = (<span class="keywordtype">char</span> *)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#adeb60802490746e21cfbed00687741c1" title="Device descriptor.">deviceDescr</a>[1];
<a name="l00336"></a>00336              inOutFlag   = <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>;
<a name="l00337"></a>00337              <span class="keywordflow">break</span>;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga7a32d5f05f3fe8b90be4e4bde163d04c" title="USB HID Descriptor Type Value.">CSL_USB_HID_DESCRIPTOR_TYPE</a>:
<a name="l00340"></a>00340              inOutFlag = (<a class="code" href="group__CSL__USB__SYMBOL.html#gad3c23824bea6fec6a3b2ca672a576fef">CSL_USB_IOFLAG_LNK</a> | <a class="code" href="group__CSL__USB__SYMBOL.html#ga665066a7eec07dd00b67ee02535d2e4f">CSL_USB_IOFLAG_CAT</a>);
<a name="l00341"></a>00341              Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a1ff6ef3ad2fb1955fa5e7d3d98dfd759" title="Configuration descriptor.">confDescr</a>[10]&amp;0xFF;
<a name="l00342"></a>00342              destPtr     = (<span class="keywordtype">char</span> *)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a1ff6ef3ad2fb1955fa5e7d3d98dfd759" title="Configuration descriptor.">confDescr</a>[10];
<a name="l00343"></a>00343              inOutFlag = <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>;
<a name="l00344"></a>00344 
<a name="l00345"></a>00345              <span class="keywordflow">if</span>(Desc_length == usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a>)
<a name="l00346"></a>00346              {
<a name="l00347"></a>00347                 inOutFlag |= <a class="code" href="group__CSL__USB__SYMBOL.html#ga8874c47ae40bc99a01424c1577538a25">CSL_USB_IOFLAG_NOSHORT</a>;
<a name="l00348"></a>00348              }
<a name="l00349"></a>00349              <span class="keywordflow">break</span>;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga72e84e4dda1fe78efab11926f6413326" title="USB Configuration Descriptor Type Value.">CSL_USB_CONFIGURATION_DESCRIPTOR_TYPE</a>:
<a name="l00352"></a>00352              inOutFlag = (<a class="code" href="group__CSL__USB__SYMBOL.html#gad3c23824bea6fec6a3b2ca672a576fef">CSL_USB_IOFLAG_LNK</a> | <a class="code" href="group__CSL__USB__SYMBOL.html#ga665066a7eec07dd00b67ee02535d2e4f">CSL_USB_IOFLAG_CAT</a>);
<a name="l00353"></a>00353              Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a1ff6ef3ad2fb1955fa5e7d3d98dfd759" title="Configuration descriptor.">confDescr</a>[2]&amp;0xFF;
<a name="l00354"></a>00354              destPtr = (<span class="keywordtype">char</span> *)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a1ff6ef3ad2fb1955fa5e7d3d98dfd759" title="Configuration descriptor.">confDescr</a>[1];
<a name="l00355"></a>00355 
<a name="l00356"></a>00356              <span class="keywordflow">if</span>(Desc_length == usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a>)
<a name="l00357"></a>00357              {
<a name="l00358"></a>00358                 inOutFlag |= <a class="code" href="group__CSL__USB__SYMBOL.html#ga8874c47ae40bc99a01424c1577538a25">CSL_USB_IOFLAG_NOSHORT</a>;
<a name="l00359"></a>00359              }
<a name="l00360"></a>00360              <span class="keywordflow">break</span>;
<a name="l00361"></a>00361 
<a name="l00362"></a>00362         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga0f950a82a8563d0c637cad4dd5e32743" title="USB other speed configuration Descriptor Type Value.">CSL_USB_OTHERSPEED_CFG_DESCRIPTOR_TYPE</a>:
<a name="l00363"></a>00363              inOutFlag = (<a class="code" href="group__CSL__USB__SYMBOL.html#gad3c23824bea6fec6a3b2ca672a576fef">CSL_USB_IOFLAG_LNK</a> | <a class="code" href="group__CSL__USB__SYMBOL.html#ga665066a7eec07dd00b67ee02535d2e4f">CSL_USB_IOFLAG_CAT</a>);
<a name="l00364"></a>00364              Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#acb0c0d0fdfee44564c31bbc7c9f32f92" title="Configuration descriptor.">osConfDescr</a>[2]&amp;0xFF;
<a name="l00365"></a>00365              destPtr = (<span class="keywordtype">char</span> *)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#acb0c0d0fdfee44564c31bbc7c9f32f92" title="Configuration descriptor.">osConfDescr</a>[1];
<a name="l00366"></a>00366 
<a name="l00367"></a>00367              <span class="keywordflow">if</span>(Desc_length == usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a>)
<a name="l00368"></a>00368              {
<a name="l00369"></a>00369                 inOutFlag |= <a class="code" href="group__CSL__USB__SYMBOL.html#ga8874c47ae40bc99a01424c1577538a25">CSL_USB_IOFLAG_NOSHORT</a>;
<a name="l00370"></a>00370              }
<a name="l00371"></a>00371              <span class="keywordflow">break</span>;
<a name="l00372"></a>00372 
<a name="l00373"></a>00373         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga53272d9c1da4ab92945aea678534a50e" title="USB String Descriptor Type Value.">CSL_USB_STRING_DESCRIPTOR_TYPE</a>:
<a name="l00374"></a>00374 <span class="comment">//          if ((usbSetup-&gt;wValue&amp;0x00FF)&gt;3)</span>
<a name="l00375"></a>00375 <span class="comment">//              return(CSL_HID_REQUEST_STALL);</span>
<a name="l00376"></a>00376 
<a name="l00377"></a>00377                  <span class="comment">/* strlen of the string requested */</span>
<a name="l00378"></a>00378             Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a9813742d4718ac68db6cb934889e9967" title="String descriptor pointer.">strDescr</a>[usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a>&amp;0x00FF][0]&amp;0x00FF;
<a name="l00379"></a>00379             destPtr = (<span class="keywordtype">char</span> *)&amp;(pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a9813742d4718ac68db6cb934889e9967" title="String descriptor pointer.">strDescr</a>[usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a>&amp;0x00FF][0]);
<a name="l00380"></a>00380             inOutFlag = <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>;
<a name="l00381"></a>00381             <span class="keywordflow">break</span>;
<a name="l00382"></a>00382 
<a name="l00383"></a>00383         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga1006ea8307baedf1f8686aac4198996d" title="USB Interface Descriptor Type Value.">CSL_USB_INTERFACE_DESCRIPTOR_TYPE</a>:
<a name="l00384"></a>00384              inOutFlag = (<a class="code" href="group__CSL__USB__SYMBOL.html#gad3c23824bea6fec6a3b2ca672a576fef">CSL_USB_IOFLAG_LNK</a> | <a class="code" href="group__CSL__USB__SYMBOL.html#ga665066a7eec07dd00b67ee02535d2e4f">CSL_USB_IOFLAG_CAT</a>);
<a name="l00385"></a>00385              Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a1ff6ef3ad2fb1955fa5e7d3d98dfd759" title="Configuration descriptor.">confDescr</a>[9]&amp;0xFF;
<a name="l00386"></a>00386              destPtr = (<span class="keywordtype">char</span> *)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a1ff6ef3ad2fb1955fa5e7d3d98dfd759" title="Configuration descriptor.">confDescr</a>[9];
<a name="l00387"></a>00387              inOutFlag = <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>;
<a name="l00388"></a>00388 
<a name="l00389"></a>00389              <span class="keywordflow">if</span>(Desc_length == usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a>)
<a name="l00390"></a>00390              {
<a name="l00391"></a>00391                 inOutFlag |= <a class="code" href="group__CSL__USB__SYMBOL.html#ga8874c47ae40bc99a01424c1577538a25">CSL_USB_IOFLAG_NOSHORT</a>;
<a name="l00392"></a>00392              }
<a name="l00393"></a>00393             <span class="keywordflow">break</span>;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga01a40f8ef9a56c48808350adf99f0f8a" title="USB End point Descriptor Type Value.">CSL_USB_ENDPOINT_DESCRIPTOR_TYPE</a>:
<a name="l00396"></a>00396              inOutFlag = (<a class="code" href="group__CSL__USB__SYMBOL.html#gad3c23824bea6fec6a3b2ca672a576fef">CSL_USB_IOFLAG_LNK</a> | <a class="code" href="group__CSL__USB__SYMBOL.html#ga665066a7eec07dd00b67ee02535d2e4f">CSL_USB_IOFLAG_CAT</a>);
<a name="l00397"></a>00397              Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a1ff6ef3ad2fb1955fa5e7d3d98dfd759" title="Configuration descriptor.">confDescr</a>[18]&amp;0xFF;
<a name="l00398"></a>00398              destPtr = (<span class="keywordtype">char</span> *)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a1ff6ef3ad2fb1955fa5e7d3d98dfd759" title="Configuration descriptor.">confDescr</a>[18];
<a name="l00399"></a>00399              inOutFlag = <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401              <span class="keywordflow">if</span>(Desc_length == usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a>)
<a name="l00402"></a>00402              {
<a name="l00403"></a>00403                 inOutFlag |= <a class="code" href="group__CSL__USB__SYMBOL.html#ga8874c47ae40bc99a01424c1577538a25">CSL_USB_IOFLAG_NOSHORT</a>;
<a name="l00404"></a>00404              }
<a name="l00405"></a>00405             <span class="keywordflow">break</span>;
<a name="l00406"></a>00406 
<a name="l00407"></a>00407         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga1d19995a65e80b690d3d88dc665d7342" title="USB deice qualifier Descriptor Type Value.">CSL_USB_DEVICE_QUAL_DESCRIPTOR_TYPE</a>:
<a name="l00408"></a>00408             Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a40241c300e728b03be36732e4423ef28" title="Device qualifier descriptor (Used in Full soeed mode)">deviceQualifierDescr</a>[1] &amp; 0xFF;
<a name="l00409"></a>00409             destPtr = (<span class="keywordtype">char</span> *)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a40241c300e728b03be36732e4423ef28" title="Device qualifier descriptor (Used in Full soeed mode)">deviceQualifierDescr</a>[1];
<a name="l00410"></a>00410             inOutFlag = <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>;
<a name="l00411"></a>00411             <span class="keywordflow">break</span>;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga31d50a15aa3085f0e87e595bdf36f1ac" title="USB HID Report Descriptor Type Value.">CSL_USB_HID_REPORT_DESCRIPTOR_TYPE</a>:
<a name="l00414"></a>00414             Desc_length = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#ae4925d8e4a77c9f96d472886c7cc7468" title="Hid Class HID report descriptor length.">hidClassHidReportDescrLen</a>;
<a name="l00415"></a>00415             destPtr = (<span class="keywordtype">char</span> *)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a40b3d86951d38d2a8cfe631f5a4431aa" title="Hid Class HID report descriptor.">hidClassHidReportDescr</a>[1];
<a name="l00416"></a>00416             inOutFlag = <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>;
<a name="l00417"></a>00417             <span class="keywordflow">break</span>;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419         <span class="keywordflow">default</span>:
<a name="l00420"></a>00420             <span class="keywordflow">return</span>(CSL_HID_REQUEST_STALL);
<a name="l00421"></a>00421     }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423     <span class="keywordflow">if</span> (Desc_length == 0)
<a name="l00424"></a>00424     {
<a name="l00425"></a>00425         <span class="keywordflow">return</span>(CSL_HID_REQUEST_STALL);
<a name="l00426"></a>00426     }
<a name="l00427"></a>00427     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a> &lt;= (Uint16)Desc_length) &amp;&amp; (Desc_length &lt;= 64))
<a name="l00428"></a>00428     {
<a name="l00429"></a>00429         <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a>,
<a name="l00430"></a>00430                             (<span class="keywordtype">void</span>*)destPtr,
<a name="l00431"></a>00431                             <a class="code" href="group__CSL__USB__SYMBOL.html#ga3b57c0b9ab404ea77f1ce71b57d81d9f" title="Flags for transfer functions.">CSL_USB_IN_TRANSFER</a>);
<a name="l00432"></a>00432     }
<a name="l00433"></a>00433     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a> &gt; ((Uint16)(Desc_length)) &amp;&amp; Desc_length &lt;= 64)
<a name="l00434"></a>00434     {
<a name="l00435"></a>00435         <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, Desc_length,
<a name="l00436"></a>00436                             (<span class="keywordtype">void</span>*)destPtr,
<a name="l00437"></a>00437                             <a class="code" href="group__CSL__USB__SYMBOL.html#ga3b57c0b9ab404ea77f1ce71b57d81d9f" title="Flags for transfer functions.">CSL_USB_IN_TRANSFER</a>);
<a name="l00438"></a>00438     }
<a name="l00439"></a>00439     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a> &lt;= 64 &amp;&amp; Desc_length &gt; 64)
<a name="l00440"></a>00440     {
<a name="l00441"></a>00441         <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a>,
<a name="l00442"></a>00442                             (<span class="keywordtype">void</span>*)destPtr,
<a name="l00443"></a>00443                             <a class="code" href="group__CSL__USB__SYMBOL.html#ga3b57c0b9ab404ea77f1ce71b57d81d9f" title="Flags for transfer functions.">CSL_USB_IN_TRANSFER</a>);
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a> &gt; 64) &amp;&amp; (Desc_length &gt; 64))
<a name="l00446"></a>00446     {
<a name="l00447"></a>00447         incrPtr = 0;
<a name="l00448"></a>00448         <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, 64,
<a name="l00449"></a>00449                             (<span class="keywordtype">void</span>*)destPtr,
<a name="l00450"></a>00450                             <a class="code" href="group__CSL__USB__SYMBOL.html#ga3b57c0b9ab404ea77f1ce71b57d81d9f" title="Flags for transfer functions.">CSL_USB_IN_TRANSFER</a>);
<a name="l00451"></a>00451 
<a name="l00452"></a>00452         <span class="keywordflow">if</span> (usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a> &gt; ((Uint16)Desc_length))
<a name="l00453"></a>00453         {
<a name="l00454"></a>00454             Desc_length = Desc_length - 64;
<a name="l00455"></a>00455         }
<a name="l00456"></a>00456         <span class="keywordflow">else</span>
<a name="l00457"></a>00457         {
<a name="l00458"></a>00458             Desc_length = usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a> - 64;
<a name="l00459"></a>00459         }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461         incrPtr = 64;
<a name="l00462"></a>00462 
<a name="l00463"></a>00463         <span class="keywordflow">while</span> (Desc_length &gt; 0)
<a name="l00464"></a>00464         {
<a name="l00465"></a>00465             <span class="keywordflow">if</span> (Desc_length &gt; 64)
<a name="l00466"></a>00466             {
<a name="l00467"></a>00467                 <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, 64,
<a name="l00468"></a>00468                                     (<span class="keywordtype">void</span>*)(destPtr + incrPtr),
<a name="l00469"></a>00469                                     <a class="code" href="group__CSL__USB__SYMBOL.html#ga3b57c0b9ab404ea77f1ce71b57d81d9f" title="Flags for transfer functions.">CSL_USB_IN_TRANSFER</a>);
<a name="l00470"></a>00470                 incrPtr += 64;
<a name="l00471"></a>00471                 Desc_length -= 64;
<a name="l00472"></a>00472             }
<a name="l00473"></a>00473             <span class="keywordflow">else</span>
<a name="l00474"></a>00474             {
<a name="l00475"></a>00475                 <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, Desc_length,
<a name="l00476"></a>00476                                     (<span class="keywordtype">void</span>*)(destPtr + incrPtr),
<a name="l00477"></a>00477                                     <a class="code" href="group__CSL__USB__SYMBOL.html#ga3b57c0b9ab404ea77f1ce71b57d81d9f" title="Flags for transfer functions.">CSL_USB_IN_TRANSFER</a>);
<a name="l00478"></a>00478                 Desc_length = 0;
<a name="l00479"></a>00479             }
<a name="l00480"></a>00480         }
<a name="l00481"></a>00481     }
<a name="l00482"></a>00482     <span class="keywordflow">else</span>
<a name="l00483"></a>00483     {
<a name="l00484"></a>00484         <span class="keywordflow">return</span>(CSL_HID_REQUEST_STALL);
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <span class="keywordflow">return</span>(CSL_HID_REQUEST_GET_ACK);
<a name="l00488"></a>00488 }
<a name="l00489"></a>00489 
<a name="l00544"></a>00544 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00545"></a><a class="code" href="group__CSL__HID__FUNCTION.html#gac491f611e487b1ba946257d3c2a774fc">00545</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#gac491f611e487b1ba946257d3c2a774fc">HID_reqSetConfiguration</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00546"></a>00546                                           <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00547"></a>00547                                           <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00548"></a>00548                                           <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00549"></a>00549                                           <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00550"></a>00550 {
<a name="l00551"></a>00551     <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a>    retStat;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553     <a class="code" href="structCSL__HidClassStruct.html" title="HID Control Object structure.">pHidClassHandle</a>      pHidClassHdl;
<a name="l00554"></a>00554     <a class="code" href="structCSL__HidCtrlObject.html" title="USB HID Control Object structure.">CSL_HidCtrlObject</a>    *pCtrlHandle;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556     pHidClassHdl = (<a class="code" href="group__CSL__HID__DATASTRUCT.html#ga9ecd1a15a6500054d7691fb78b9feb5c" title="Hid Class class handle.">pHidClassHandle</a>)(pHidObj);
<a name="l00557"></a>00557     pCtrlHandle  = &amp;pHidClassHdl-&gt;<a class="code" href="structCSL__HidClassStruct.html#a159f6e7bfae4815bb6e6e83583b8678d" title="Handle to Control Object.">ctrlHandle</a>;
<a name="l00558"></a>00558 
<a name="l00559"></a>00559     <span class="keywordflow">if</span>((usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a> == FALSE) || (usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a> == TRUE))
<a name="l00560"></a>00560     {
<a name="l00561"></a>00561         pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a10bac669221c436f0e37382a9ede8ad7" title="Current Device Configuration Status.">curConfigStat</a> = usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a>;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563         <a class="code" href="group__CSL__USB__FUNCTION.html#ga2afe1be9825d404c775e8570b85338c2">USB_setConfiguration</a>(devHandle, usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a>);
<a name="l00564"></a>00564 
<a name="l00565"></a>00565         retStat   = CSL_HID_REQUEST_SEND_ACK;
<a name="l00566"></a>00566     }
<a name="l00567"></a>00567     <span class="keywordflow">else</span>
<a name="l00568"></a>00568     {
<a name="l00569"></a>00569         <span class="comment">/* configuration not supported, STALL the endpoint */</span>
<a name="l00570"></a>00570         retStat = CSL_HID_REQUEST_STALL;
<a name="l00571"></a>00571     }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573     <span class="keywordflow">return</span>(retStat);
<a name="l00574"></a>00574 }
<a name="l00575"></a>00575 
<a name="l00630"></a>00630 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00631"></a><a class="code" href="group__CSL__HID__FUNCTION.html#ga3d5720b2087c7b397a172a04eb984ba0">00631</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#ga3d5720b2087c7b397a172a04eb984ba0">HID_reqClearFeature</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00632"></a>00632                                       <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00633"></a>00633                                       <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00634"></a>00634                                       <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00635"></a>00635                                       <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00636"></a>00636 {
<a name="l00637"></a>00637     <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a>    retStat;
<a name="l00638"></a>00638     <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>      hEPx;
<a name="l00639"></a>00639 
<a name="l00640"></a>00640     retStat = CSL_HID_REQUEST_SEND_ACK;
<a name="l00641"></a>00641 
<a name="l00642"></a>00642     <span class="keywordflow">switch</span>(usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a>)
<a name="l00643"></a>00643     {
<a name="l00644"></a>00644         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga27953368972bacf018d289d44dc0198a" title="USB End point Stall Feature.">CSL_USB_FEATURE_ENDPOINT_STALL</a>:
<a name="l00645"></a>00645             hEPx = devHandle-&gt;<a class="code" href="structCSL__UsbContext.html#a1253cd59c4f4e10544c60129c33e3e94" title="NULL terminated array of Endpoint Objects.">hEpHandleArray</a>[3];
<a name="l00646"></a>00646             <a class="code" href="group__CSL__USB__FUNCTION.html#gaa9238a073828f83b3fc474f183d53677">USB_clearEndptStall</a>(hEPx);
<a name="l00647"></a>00647             <span class="keywordflow">break</span>;
<a name="l00648"></a>00648 
<a name="l00649"></a>00649         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga53ba9c525cb99ee2fef80c60786a69ab" title="USB Remote Wakeup Feature.">CSL_USB_FEATURE_REMOTE_WAKEUP</a>:
<a name="l00650"></a>00650             <a class="code" href="group__CSL__USB__FUNCTION.html#ga697ac4bdefb5d3c8cbd3bcead1e0b23b">USB_setRemoteWakeup</a>(devHandle, (<a class="code" href="group__CSL__USB__ENUM.html#ga5d102397ad06d902df565f3a4ecc2a91" title="This enum defines status return values of USB.">CSL_UsbBoolean</a>)FALSE);
<a name="l00651"></a>00651             <span class="keywordflow">break</span>;
<a name="l00652"></a>00652 
<a name="l00653"></a>00653         <span class="keywordflow">default</span>:
<a name="l00654"></a>00654             <span class="comment">/* Unsupported Feature. STALL the endpoint */</span>
<a name="l00655"></a>00655             retStat = CSL_HID_REQUEST_STALL;
<a name="l00656"></a>00656             <span class="keywordflow">break</span>;
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659     <span class="keywordflow">return</span>(retStat);
<a name="l00660"></a>00660 }
<a name="l00661"></a>00661 
<a name="l00716"></a>00716 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00717"></a><a class="code" href="group__CSL__HID__FUNCTION.html#ga45d6740c6e6fe2028c9feb4a85fd5474">00717</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#ga45d6740c6e6fe2028c9feb4a85fd5474">HID_reqGetStatus</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00718"></a>00718                                    <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00719"></a>00719                                    <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00720"></a>00720                                    <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00721"></a>00721                                    <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00722"></a>00722 {
<a name="l00723"></a>00723     <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a>     retStat;
<a name="l00724"></a>00724     <a class="code" href="structCSL__HidClassStruct.html" title="HID Control Object structure.">pHidClassHandle</a>       pHidClassHdl;
<a name="l00725"></a>00725     <a class="code" href="structCSL__HidCtrlObject.html" title="USB HID Control Object structure.">CSL_HidCtrlObject</a>     *pCtrlHandle;
<a name="l00726"></a>00726     <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hEPx;
<a name="l00727"></a>00727     CSL_Status            status;
<a name="l00728"></a>00728 
<a name="l00729"></a>00729     pHidClassHdl = (<a class="code" href="group__CSL__HID__DATASTRUCT.html#ga9ecd1a15a6500054d7691fb78b9feb5c" title="Hid Class class handle.">pHidClassHandle</a>)(pHidObj);
<a name="l00730"></a>00730     pCtrlHandle  = &amp;pHidClassHdl-&gt;<a class="code" href="structCSL__HidClassStruct.html#a159f6e7bfae4815bb6e6e83583b8678d" title="Handle to Control Object.">ctrlHandle</a>;
<a name="l00731"></a>00731     retStat      = CSL_HID_REQUEST_GET_ACK;
<a name="l00732"></a>00732 
<a name="l00733"></a>00733     pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[0] = 0x00;
<a name="l00734"></a>00734 
<a name="l00735"></a>00735     <span class="keywordflow">switch</span>(usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a78d44b3f43dbe57fe6e94c4c8014cbf3" title="Byte 0 of setup packet.">bmRequestType</a> - <a class="code" href="group__CSL__HID__SYMBOL.html#gabe0654c622676da9d986e114901e9da7">CSL_HID_REQUEST_TYPE_BASE</a>)
<a name="l00736"></a>00736     {
<a name="l00737"></a>00737         <span class="comment">/* Device Status to be returned */</span>
<a name="l00738"></a>00738         <span class="keywordflow">case</span> <a class="code" href="group__CSL__HID__SYMBOL.html#ga8669d2f44d67abff0a531a4baacb5726">CSL_HID_REQUEST_TYPE_DEVICE_STATUS</a>:
<a name="l00739"></a>00739             pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[0] =
<a name="l00740"></a>00740                 (((Uint16)<a class="code" href="group__CSL__USB__FUNCTION.html#ga3a1737f1a1f76b2cd16120376ba777a1">USB_getRemoteWakeupStat</a>(devHandle))&lt;&lt;1) |
<a name="l00741"></a>00741                 0;<span class="comment">//CSL_HID_CURRDEV_STAT;</span>
<a name="l00742"></a>00742             <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, 2, &amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>,
<a name="l00743"></a>00743                                 <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>);
<a name="l00744"></a>00744             <span class="keywordflow">break</span>;
<a name="l00745"></a>00745 
<a name="l00746"></a>00746         <span class="comment">/* Interface status is to be returned */</span>
<a name="l00747"></a>00747         <span class="keywordflow">case</span> <a class="code" href="group__CSL__HID__SYMBOL.html#gab185378ee4e9a5c839e9d5d12e119b84">CSL_HID_REQUEST_TYPE_INTERFACE_STATUS</a>:
<a name="l00748"></a>00748             <span class="comment">//pCtrlHandle-&gt;ctrlBuffer[1] = CSL_HID_CURRDEV_STAT;</span>
<a name="l00749"></a>00749             pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[0] = 0x0; <span class="comment">/* request to interface returns 0 */</span>
<a name="l00750"></a>00750             <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, 2, &amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>,
<a name="l00751"></a>00751                                 <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>);
<a name="l00752"></a>00752             <span class="keywordflow">break</span>;
<a name="l00753"></a>00753 
<a name="l00754"></a>00754         <span class="comment">/* Endpoint status to be returned */</span>
<a name="l00755"></a>00755         <span class="keywordflow">case</span> <a class="code" href="group__CSL__HID__SYMBOL.html#ga1b30fd65af166d3e8d117f3b68b13b79">CSL_HID_REQUEST_TYPE_EP_STATUS</a>:
<a name="l00756"></a>00756             hEPx   =  devHandle-&gt;<a class="code" href="structCSL__UsbContext.html#a1253cd59c4f4e10544c60129c33e3e94" title="NULL terminated array of Endpoint Objects.">hEpHandleArray</a>[3];
<a name="l00757"></a>00757             pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[0] = (Uint16)<a class="code" href="group__CSL__USB__FUNCTION.html#gadad6e2731853b7b0edeb2fd65dc24fd0">USB_getEndptStall</a>(hEPx,
<a name="l00758"></a>00758                                                                    &amp;status);
<a name="l00759"></a>00759             <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, 2, &amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>,
<a name="l00760"></a>00760                                 <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>);
<a name="l00761"></a>00761             <span class="keywordflow">break</span>;
<a name="l00762"></a>00762 
<a name="l00763"></a>00763         <span class="keywordflow">default</span>:
<a name="l00764"></a>00764             <span class="comment">/* STALL the endpoint */</span>
<a name="l00765"></a>00765             retStat = CSL_HID_REQUEST_STALL;
<a name="l00766"></a>00766             <span class="keywordflow">break</span>;
<a name="l00767"></a>00767     }
<a name="l00768"></a>00768 
<a name="l00769"></a>00769     <span class="keywordflow">return</span>(retStat);
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 
<a name="l00826"></a>00826 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00827"></a><a class="code" href="group__CSL__HID__FUNCTION.html#ga89fcc74dfd020591cbf2a66e5d896438">00827</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#ga89fcc74dfd020591cbf2a66e5d896438">HID_reqSetFeature</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00828"></a>00828                                     <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00829"></a>00829                                     <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00830"></a>00830                                     <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00831"></a>00831                                     <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833     <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a>    retStat;
<a name="l00834"></a>00834     <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>      hEPx;
<a name="l00835"></a>00835 
<a name="l00836"></a>00836     retStat = CSL_HID_REQUEST_SEND_ACK;
<a name="l00837"></a>00837 
<a name="l00838"></a>00838     <span class="keywordflow">switch</span>(usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a>)
<a name="l00839"></a>00839     {
<a name="l00840"></a>00840         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga27953368972bacf018d289d44dc0198a" title="USB End point Stall Feature.">CSL_USB_FEATURE_ENDPOINT_STALL</a>:
<a name="l00841"></a>00841             <span class="comment">/* updated set and clear endpoint stall to work with logical endpoint num */</span>
<a name="l00842"></a>00842             hEPx = devHandle-&gt;<a class="code" href="structCSL__UsbContext.html#a1253cd59c4f4e10544c60129c33e3e94" title="NULL terminated array of Endpoint Objects.">hEpHandleArray</a>[3];
<a name="l00843"></a>00843             <a class="code" href="group__CSL__USB__FUNCTION.html#gaa1befea5ae93ae7079e52df923a54c21">USB_stallEndpt</a>(hEPx);
<a name="l00844"></a>00844             <span class="keywordflow">break</span>;
<a name="l00845"></a>00845 
<a name="l00846"></a>00846         <span class="keywordflow">case</span> <a class="code" href="group__CSL__USB__SYMBOL.html#ga53ba9c525cb99ee2fef80c60786a69ab" title="USB Remote Wakeup Feature.">CSL_USB_FEATURE_REMOTE_WAKEUP</a>:
<a name="l00847"></a>00847             <a class="code" href="group__CSL__USB__FUNCTION.html#ga697ac4bdefb5d3c8cbd3bcead1e0b23b">USB_setRemoteWakeup</a>(devHandle, (<a class="code" href="group__CSL__USB__ENUM.html#ga5d102397ad06d902df565f3a4ecc2a91" title="This enum defines status return values of USB.">CSL_UsbBoolean</a>)TRUE);
<a name="l00848"></a>00848             <span class="keywordflow">break</span>;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850         <span class="keywordflow">default</span>:
<a name="l00851"></a>00851             <span class="comment">/* Feature not supported, STALL the endpoint */</span>
<a name="l00852"></a>00852             retStat = CSL_HID_REQUEST_STALL;
<a name="l00853"></a>00853             <span class="keywordflow">break</span>;
<a name="l00854"></a>00854     }
<a name="l00855"></a>00855 
<a name="l00856"></a>00856   <span class="keywordflow">return</span>(retStat);
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 
<a name="l00912"></a>00912 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00913"></a><a class="code" href="group__CSL__HID__FUNCTION.html#ga2e84b637b78dd11a979c8a8425e6b2b6">00913</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#ga2e84b637b78dd11a979c8a8425e6b2b6">HID_reqGetConfiguration</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00914"></a>00914                                           <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00915"></a>00915                                           <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00916"></a>00916                                           <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00917"></a>00917                                           <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00918"></a>00918 {
<a name="l00919"></a>00919     <a class="code" href="structCSL__HidClassStruct.html" title="HID Control Object structure.">pHidClassHandle</a>       pHidClassHdl;
<a name="l00920"></a>00920     <a class="code" href="structCSL__HidCtrlObject.html" title="USB HID Control Object structure.">CSL_HidCtrlObject</a>*    pCtrlHandle;
<a name="l00921"></a>00921 
<a name="l00922"></a>00922     pHidClassHdl = (<a class="code" href="group__CSL__HID__DATASTRUCT.html#ga9ecd1a15a6500054d7691fb78b9feb5c" title="Hid Class class handle.">pHidClassHandle</a>)(pHidObj);
<a name="l00923"></a>00923     pCtrlHandle  = &amp;pHidClassHdl-&gt;<a class="code" href="structCSL__HidClassStruct.html#a159f6e7bfae4815bb6e6e83583b8678d" title="Handle to Control Object.">ctrlHandle</a>;
<a name="l00924"></a>00924 
<a name="l00925"></a>00925     <span class="comment">/* Send the current Configuration Value */</span>
<a name="l00926"></a>00926     pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[0] = pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a10bac669221c436f0e37382a9ede8ad7" title="Current Device Configuration Status.">curConfigStat</a>;
<a name="l00927"></a>00927     <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, 1, (<span class="keywordtype">void</span>*)&amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>,
<a name="l00928"></a>00928                         <a class="code" href="group__CSL__USB__SYMBOL.html#ga3b57c0b9ab404ea77f1ce71b57d81d9f" title="Flags for transfer functions.">CSL_USB_IN_TRANSFER</a>);<span class="comment">//CSL_USB_IOFLAG_NONE | CSL_USB_IOFLAG_NOSHORT);</span>
<a name="l00929"></a>00929 
<a name="l00930"></a>00930     <span class="keywordflow">return</span>(CSL_HID_REQUEST_GET_ACK);
<a name="l00931"></a>00931 }
<a name="l00932"></a>00932 
<a name="l00988"></a>00988 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00989"></a><a class="code" href="group__CSL__HID__FUNCTION.html#gae48e0da3633c84b34240373105d7ef7c">00989</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#gae48e0da3633c84b34240373105d7ef7c">HID_reqGetMaxLUN</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l00990"></a>00990                                    <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l00991"></a>00991                                    <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l00992"></a>00992                                    <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l00993"></a>00993                                    <span class="keywordtype">void</span>                  *pHidObj)
<a name="l00994"></a>00994 {
<a name="l00995"></a>00995     <a class="code" href="structCSL__HidClassStruct.html" title="HID Control Object structure.">pHidClassHandle</a>       pHidClassHdl;
<a name="l00996"></a>00996     <a class="code" href="structCSL__HidCtrlObject.html" title="USB HID Control Object structure.">CSL_HidCtrlObject</a>*    pCtrlHandle;
<a name="l00997"></a>00997     <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a>     retStat;
<a name="l00998"></a>00998 
<a name="l00999"></a>00999     pHidClassHdl = (<a class="code" href="group__CSL__HID__DATASTRUCT.html#ga9ecd1a15a6500054d7691fb78b9feb5c" title="Hid Class class handle.">pHidClassHandle</a>)(pHidObj);
<a name="l01000"></a>01000     pCtrlHandle  = &amp;pHidClassHdl-&gt;<a class="code" href="structCSL__HidClassStruct.html#a159f6e7bfae4815bb6e6e83583b8678d" title="Handle to Control Object.">ctrlHandle</a>;
<a name="l01001"></a>01001     pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[1] = pHidClassHdl-&gt;<a class="code" href="structCSL__HidClassStruct.html#a85c12b484c3ede6a97fbe734015ac32a" title="Handle to Iso Transfer Object.">hidHandle</a>.<a class="code" href="structCSL__HidObject.html#a91502ddd02d675d1354f74e8d0d44cf3" title="Maximum No.of Logical Units.">noOfLun</a>;
<a name="l01002"></a>01002 
<a name="l01003"></a>01003     <span class="keywordflow">if</span>(pHidClassHdl-&gt;<a class="code" href="structCSL__HidClassStruct.html#a85c12b484c3ede6a97fbe734015ac32a" title="Handle to Iso Transfer Object.">hidHandle</a>.<a class="code" href="structCSL__HidObject.html#a91502ddd02d675d1354f74e8d0d44cf3" title="Maximum No.of Logical Units.">noOfLun</a> &gt; 0)
<a name="l01004"></a>01004     {
<a name="l01005"></a>01005         <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, 1, &amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[0],
<a name="l01006"></a>01006                             <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>);
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         <span class="comment">/*Receive a 0 length packet for acknowledgement */</span>
<a name="l01009"></a>01009         retStat = CSL_HID_REQUEST_GET_ACK;
<a name="l01010"></a>01010     }
<a name="l01011"></a>01011     <span class="keywordflow">else</span>
<a name="l01012"></a>01012     {
<a name="l01013"></a>01013         retStat = CSL_HID_REQUEST_STALL;
<a name="l01014"></a>01014     }
<a name="l01015"></a>01015 
<a name="l01016"></a>01016     <span class="keywordflow">return</span> (retStat);
<a name="l01017"></a>01017 }
<a name="l01018"></a>01018 
<a name="l01074"></a>01074 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l01075"></a><a class="code" href="group__CSL__HID__FUNCTION.html#ga76bca7a59e344d641ebf9799af3fec49">01075</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#ga76bca7a59e344d641ebf9799af3fec49">HID_reqSetInterface</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l01076"></a>01076                                       <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l01077"></a>01077                                       <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l01078"></a>01078                                       <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l01079"></a>01079                                       <span class="keywordtype">void</span>                  *pHidObj)
<a name="l01080"></a>01080 {
<a name="l01081"></a>01081     <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a>    retStat;
<a name="l01082"></a>01082 
<a name="l01083"></a>01083     retStat     = CSL_HID_REQUEST_SEND_ACK;
<a name="l01084"></a>01084 
<a name="l01085"></a>01085     <span class="keywordflow">if</span> ((usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a> == 0) &amp;&amp;
<a name="l01086"></a>01086         (usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a3dae40396cdd9c4d62e7e1a017d94774" title="Byte 4 and 5 setup packet.">wIndex</a> == 0) &amp;&amp;
<a name="l01087"></a>01087         (usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a> == 0))
<a name="l01088"></a>01088     {
<a name="l01089"></a>01089         CSL_FINS(<a class="code" href="group__CSL__CDC__DATASTRUCT.html#ga3a779f02649275a99b98db0eec619e5f">usbRegisters</a>-&gt;PERI_CSR0_INDX,
<a name="l01090"></a>01090                  USB_PERI_CSR0_INDX_DATAEND, TRUE);
<a name="l01091"></a>01091 
<a name="l01092"></a>01092         retStat = CSL_HID_REQUEST_SEND_ACK;
<a name="l01093"></a>01093     }
<a name="l01094"></a>01094     <span class="keywordflow">else</span>
<a name="l01095"></a>01095     {
<a name="l01096"></a>01096         <span class="comment">/* Interface not supported, STALL the endpoint */</span>
<a name="l01097"></a>01097         retStat = CSL_HID_REQUEST_STALL;
<a name="l01098"></a>01098     }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100     <span class="keywordflow">return</span>(retStat);
<a name="l01101"></a>01101 }
<a name="l01102"></a>01102 
<a name="l01158"></a>01158 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l01159"></a><a class="code" href="group__CSL__HID__FUNCTION.html#gaa8cb0664ab75037722ee1208c2f39d13">01159</a> <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a> <a class="code" href="group__CSL__HID__FUNCTION.html#gaa8cb0664ab75037722ee1208c2f39d13">HID_reqGetInterface</a>(<a class="code" href="structCSL__UsbContext.html" title="USB context information structure.">CSL_UsbDevHandle</a>      devHandle,
<a name="l01160"></a>01160                                       <a class="code" href="structCSL__UsbSetupStruct.html" title="Data structure to hold USB setup packet.">CSL_UsbSetupStruct</a>    *usbSetup,
<a name="l01161"></a>01161                                       <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hInEp,
<a name="l01162"></a>01162                                       <a class="code" href="structCSL__UsbEpObj.html" title="Data Structure for USB Endpoint Object.">CSL_UsbEpHandle</a>       hOutEp,
<a name="l01163"></a>01163                                       <span class="keywordtype">void</span>                  *pHidObj)
<a name="l01164"></a>01164 {
<a name="l01165"></a>01165     <a class="code" href="structCSL__HidClassStruct.html" title="HID Control Object structure.">pHidClassHandle</a>       pHidClassHdl;
<a name="l01166"></a>01166     <a class="code" href="structCSL__HidCtrlObject.html" title="USB HID Control Object structure.">CSL_HidCtrlObject</a>     *pCtrlHandle;
<a name="l01167"></a>01167     <a class="code" href="group__CSL__HID__ENUM.html#gacf2769428455233b0b1e239eb2a708d9" title="This Enum defines the Hid request return values.">CSL_HidRequestRet</a>     retStat;
<a name="l01168"></a>01168 
<a name="l01169"></a>01169     pHidClassHdl = (<a class="code" href="group__CSL__HID__DATASTRUCT.html#ga9ecd1a15a6500054d7691fb78b9feb5c" title="Hid Class class handle.">pHidClassHandle</a>)(pHidObj);
<a name="l01170"></a>01170     pCtrlHandle  = &amp;pHidClassHdl-&gt;<a class="code" href="structCSL__HidClassStruct.html#a159f6e7bfae4815bb6e6e83583b8678d" title="Handle to Control Object.">ctrlHandle</a>;
<a name="l01171"></a>01171     retStat      = CSL_HID_REQUEST_GET_ACK;
<a name="l01172"></a>01172 
<a name="l01173"></a>01173     <span class="comment">/* Compare the Interface with the bNumInterfaces byte of Configuration Descriptor */</span>
<a name="l01174"></a>01174     <span class="keywordflow">if</span> ((usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a20b94e0080d670cfd371b622838f24a7" title="Byte 2 and 3 of setup packet.">wValue</a> == 0) &amp;&amp;
<a name="l01175"></a>01175         (usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a3dae40396cdd9c4d62e7e1a017d94774" title="Byte 4 and 5 setup packet.">wIndex</a> == 0) &amp;&amp;
<a name="l01176"></a>01176         (usbSetup-&gt;<a class="code" href="structCSL__UsbSetupStruct.html#a99f4f2c530e96b3b48fcfe75d63f3d72" title="Byte 6 and 7 of setup packet.">wLength</a> == 0))
<a name="l01177"></a>01177     {
<a name="l01178"></a>01178         <span class="comment">/* Send the current Interface Value */</span>
<a name="l01179"></a>01179         pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[1] = 0;
<a name="l01180"></a>01180         <a class="code" href="group__CSL__USB__FUNCTION.html#ga0976835f84a5fedd800c643e6c86703e">USB_postTransaction</a>(hInEp, 1, &amp;pCtrlHandle-&gt;<a class="code" href="structCSL__HidCtrlObject.html#a0953396ed19f194c4798a2a1023cf054" title="Array used for General Purpose.">ctrlBuffer</a>[0],
<a name="l01181"></a>01181                             <a class="code" href="group__CSL__USB__SYMBOL.html#ga7bd2d646e37049bcdf340f27ca927e29" title="USB IO Flags.">CSL_USB_IOFLAG_NONE</a>);
<a name="l01182"></a>01182     }
<a name="l01183"></a>01183     <span class="keywordflow">else</span>
<a name="l01184"></a>01184     {
<a name="l01185"></a>01185         <span class="comment">/*  Interface specified doent exist, STALL the endpoint */</span>
<a name="l01186"></a>01186         retStat = CSL_HID_REQUEST_STALL;
<a name="l01187"></a>01187     }
<a name="l01188"></a>01188 
<a name="l01189"></a>01189     <span class="keywordflow">return</span> retStat;
<a name="l01190"></a>01190 }
<a name="l01191"></a>01191 
<a name="l01195"></a>01195 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l01196"></a>01196 <span class="preprocessor"></span>}
<a name="l01197"></a>01197 <span class="preprocessor">#endif</span>
<a name="l01198"></a>01198 <span class="preprocessor"></span>
<a name="l01199"></a>01199 <span class="preprocessor">#endif    // _CSL_HIDCLASSAUX_H_</span>
<a name="l01200"></a>01200 <span class="preprocessor"></span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Mar 27 2013 13:32:42 for C55XX CSL LP by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
